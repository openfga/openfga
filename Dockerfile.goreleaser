FROM alpine AS builder
ARG OS=linux
ARG ARCH=amd64
RUN apk add --no-cache wget
RUN wget -q -O /bin/grpc_health_probe "https://github.com/grpc-ecosystem/grpc-health-probe/releases/download/v0.4.13/grpc_health_probe-${OS}-${ARCH}"

FROM alpine

COPY assets /assets
COPY openfga /
COPY --from=builder /bin/grpc_health_probe /bin/grpc_health_probe
RUN chmod +x /bin/grpc_health_probe
ENTRYPOINT ["/openfga"]
