tests:
  - name: nil_tuple
    model: |
        type user
    code: 3

  - name: empty_tuple
    model: |
      type user
    request:
      tuple:
        object:
        relation:
        user:
    code: 2009

  - name: empty_object
    model: |
      type user
    request:
      tuple:
        object:
        relation: viewer
        user: user:aardvark
    code: 2009

  - name: empty_relation
    model: |
      type user
    request:
      tuple:
        object: user:aardvark
        relation:
        user: user:badger
    code: 2009

  - name: empty_user
    model: |
      type user
    request:
      tuple:
        object: user:aardvark
        relation: viewer
        user:
    code: 2009

  - name: relation_not_in_model
    model: |
      type user
    request:
      tuple:
        object: user:aardvark
        relation: viewer
        user: user:badger
    code: 2000

  - name: user_type_not_in_model
    model: |
      type user
      
      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: folder:x
    code: 2000

  - name: userset_type_not_in_model
    model: |
      type user

      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: folder:x#writer
    code: 2000

  - name: userset_relation_not_in_model
    model: |
      type user

      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: document:x#writer
    code: 2000

  - name: user_invalid
    model: |
      type user
      
      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: a:b:c
    code: 2000

  - name: circular_model
    model: |   
      type user
      
      type document
        relations
          define viewer as writer
          define writer as viewer
    request:
      tuple:
        object: document:1
        relation: viewer
        user: user:aardvark
    code: 2002

  - name: invalid_object_type_in_contextual_tuple
    model: |
      type user

      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: user:aardvark
      contextualTuples:
        - object: folder:x
          relation: viewer
          user: user:aardvark
    code: 2027

  - name: invalid_relation_in_contextual_tuple
    model: |
      type user

      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: user:aardvark
      contextualTuples:
        - object: document:1
          relation: writer
          user: user:aardvark
    code: 2027

  - name: invalid_user_in_contextual_tuple
    model: |
      type user

      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: user:aardvark
      contextualTuples:
        - object: document:1
          relation: viewer
          user: employee:aardvark
    code: 2027

  - name: invalid_wildcard_in_contextual_tuple
    model: |
      type user

      type document
        relations
          define viewer: [user] as self
    request:
      tuple:
        object: document:1
        relation: viewer
        user: user:aardvark
      contextualTuples:
        - object: document:1
          relation: viewer
          user: user:*
    code: 2027

  - name: contextual_tuples_and_wildcard_in_ttu_evaluation
    model: |
      type user
      
      type folder
        relations
          define viewer: [user] as self
      
      type document
        relations
          define parent: [folder] as self
          define viewer as viewer from parent
    request:
      tuple:
        object: document:1
        relation: viewer
        user: user:aardvark
      contextualTuples:
        - object: document:1
          relation: parent
          user: user:*
    code: 2027
